/**
 * A simple jQuery slideShow modal (http://github.com/xylphid/jquery-slideshow)
 * Version 0.1.0
 */
!function(e){var s=null;e.slideshow=function(s,i){e.slideshow.close(),this.options=e.extend({},e.slideshow.defaults,i),this.$elm=s,this.working=!1,this.$slideshow=e('<div id="jquery-slideshow"></div>'),this.$slideshow.append(this.getActions()),this.$slideshow.modal({fadeDuration:200,fadeDelay:.8,modalClass:"modal slide-show",showClose:!1}),e(document).on(e.modal.OPEN,function(){e.slideshow.showSlide(),e.modal.resize()}),e(document).on("keydown.slideshow",function(s){37==s.which&&e.slideshow.prev(),39==s.which&&e.slideshow.next()})},e.slideshow.prototype={constructor:e.slideshow,close:function(){this.interval&&(this.interval=clearInterval(this.interval)),e.modal.close(),e("#jquery-slideshow").remove(),e(document).off("keydown.slideshow")},getActions:function(){return actions=e('<div class="actions"></div>').append('<a class="fullscreen" rel="slideshow:fullscreen"></a>').append('<a class="close" rel="slideshow:close"></a>'),target=this.$elm.attr("data-target"),("undefined"!=typeof target||"slideshow"==target)&&actions.prepend('<a class="play" rel="slideshow:play"></a>').prepend('<a class="next" rel="slideshow:next"></a>').prepend('<a class="prev" rel="slideshow:prev"></a>'),actions},getSize:function(){return{x:this.$slideshow.width(),y:this.$slideshow.height()}},showSpinner:function(){this.working=!0,this.options.showSpinner&&(this.spinner=this.spinner||e('<div class="spinner"></div>'),this.$slideshow.prepend(this.spinner))},hideSpinner:function(){this.spinner&&this.spinner.remove(),this.working=!1},showSlide:function(){this.showSpinner(),size=this.getSize(),resizeUrl=this.options.resize?this.options.resizePattern.replace("{width}",size.x).replace("{height}",size.y):"",e("<img />").attr("src",this.$elm.attr("href")+resizeUrl).addClass("slide").addClass(this.options.scaling).attr("alt","Slideshow").swipe({swipeRight:e.slideshow.prev,swipeLeft:e.slideshow.next,threshold:30}).load(function(){e(".slide-show > .slide").remove(),e(".slide-show").prepend(e(this)),e(this).fadeIn(function(){if(e(this).hasClass("fill")){var s=e(window).width()>e(window).height()?e(window).width()/e(this).width():e(window).height()/e(this).height();e(this).css("transform-origin","0px").css("transform","scale("+s+")")}e.slideshow.hideSpinner()})})},next:function(){if(target=this.$elm.attr("data-target"),"undefined"!=typeof target&&"slideshow"==target&&!this.working){var s=e("[data-target="+this.$elm.attr("data-target")+"]"),i=this.$elm.index()+1;this.$elm=s.eq(s.length>i?i:0),this.showSlide()}},prev:function(){if(target=this.$elm.attr("data-target"),"undefined"!=typeof target&&"slideshow"==target&&!this.working){this.working=!0;var s=e("[data-target="+this.$elm.attr("data-target")+"]"),i=this.$elm.index()-1;this.$elm=s.eq(i>0?i:s.length-1),this.showSlide()}},play:function(){this.interval=this.interval?clearInterval(this.interval):setInterval(function(){e.slideshow.next()},this.options.timeOnScreen)},fullscreen:function(){window.open(this.$elm.attr("href"))},resize:function(){e.modal.resize()}},e.slideshow.hideSpinner=function(e){return s?(e&&e.preventDefault(),s.hideSpinner(),s.$elm):void 0},e.slideshow.showSlide=function(e){return s?(e&&e.preventDefault(),s.showSlide(),s.$elm):void 0},e.slideshow.prev=function(e){return s?(e&&e.preventDefault(),s.prev(),s.$elm):void 0},e.slideshow.next=function(e){return s?(e&&e.preventDefault(),s.next(),s.$elm):void 0},e.slideshow.play=function(e){return s?(e&&e.preventDefault(),s.play(),s.$elm):void 0},e.slideshow.fullscreen=function(e){return s?(e&&e.preventDefault(),s.fullscreen(),s.$elm):void 0},e.slideshow.resize=function(e){return s?(e&&e.preventDefault(),s.resize(),s.$elm):void 0},e.slideshow.close=function(e){if(s){e&&e.preventDefault(),s.close();var i=s.$elm;return s=null,i}},e.slideshow.defaults={resize:!1,resizePattern:"/{width}/{height}",scaling:"fitmax",showSpinner:!0,timeOnScreen:5e3},e.fn.slideshow=function(i){return 1===this.length&&(s=new e.slideshow(this,i)),this},e(document).on("click.slide-show",'a[rel="slideshow:close"]',e.slideshow.close),e(document).on("click.slide-show",'a[rel="slideshow:prev"]',e.slideshow.prev),e(document).on("click.slide-show",'a[rel="slideshow:next"]',e.slideshow.next),e(document).on("click.slide-show",'a[rel="slideshow:play"]',e.slideshow.play),e(document).on("click.slide-show",'a[rel="slideshow:fullscreen"]',e.slideshow.fullscreen),e(document).on("click.slide-show",'a[rel="slideshow:open"]',function(s){s.preventDefault(),e(this).slideshow()}),e(window).on("resize",e.slideshow.resize)}(jQuery);